import React, { useState, useEffect } from 'react';
import { 
  ShoppingBag, 
  Search, 
  User, 
  Menu, 
  X, 
  Star, 
  Truck, 
  ShieldCheck, 
  ArrowLeftRight, 
  Facebook, 
  Twitter, 
  Instagram,
  ArrowRight,
  ChevronRight,
  Filter
} from 'lucide-react';

// --- Mock Data ---
const PRODUCTS = [
  {
    id: 1,
    name: "ساعة ألترا الذكية - إصدار المبدعين",
    price: 1200,
    category: "إلكترونيات",
    image: "https://images.unsplash.com/photo-1546868891-d5b8ad16a782?auto=format&fit=crop&q=80&w=500",
    description: "ساعة ذكية متطورة تدعم جميع الأنشطة الرياضية مع بطارية تدوم طويلاً وشاشة AMOLED عالية الدقة.",
    rating: 4.8,
    reviews: 124
  },
  {
    id: 2,
    name: "سماعات لاسلكية برو - عازلة للضوضاء",
    price: 850,
    category: "إلكترونيات",
    image: "https://images.unsplash.com/photo-1505740420928-5e560c06d30e?auto=format&fit=crop&q=80&w=500",
    description: "تجربة صوتية فريدة مع تقنية عزل الضوضاء النشطة وتصميم مريح للأذن للاستخدام الطويل.",
    rating: 4.9,
    reviews: 89
  },
  {
    id: 3,
    name: "حقيبة ظهر جلدية - تصميم كلاسيكي",
    price: 450,
    category: "إكسسوارات",
    image: "https://images.unsplash.com/photo-1548036328-c9fa89d128fa?auto=format&fit=crop&q=80&w=500",
    description: "حقيبة مصنوعة من الجلد الطبيعي 100%، تتسع لجهاز لابتوب 15 بوصة مع جيوب متعددة للتنظيم.",
    rating: 4.7,
    reviews: 56
  },
  {
    id: 4,
    name: "نظارة شمسية عصرية - حماية UV",
    price: 320,
    category: "إكسسوارات",
    image: "https://images.unsplash.com/photo-1572635196237-14b3f281503f?auto=format&fit=crop&q=80&w=500",
    description: "نظارات شمسية بتصميم عصري توفر حماية كاملة من الأشعة فوق البنفسجية وتناسب جميع الوجوه.",
    rating: 4.5,
    reviews: 42
  }
];

// --- Components ---

const Navbar = ({ setPage, cartCount }) => {
  const [isOpen, setIsOpen] = useState(false);

  return (
    <nav className="sticky top-0 z-50 bg-white border-b border-gray-100">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="flex justify-between h-16 items-center">
          {/* Mobile Menu Button */}
          <div className="md:hidden">
            <button onClick={() => setIsOpen(!isOpen)} className="text-gray-600">
              {isOpen ? <X size={24} /> : <Menu size={24} />}
            </button>
          </div>

          {/* Logo */}
          <div className="flex-shrink-0 flex items-center cursor-pointer" onClick={() => setPage('home')}>
            <span className="text-2xl font-bold bg-indigo-600 text-white px-2 py-1 rounded">M</span>
            <span className="ml-2 text-xl font-bold text-gray-900 tracking-tight">MODERN STORE</span>
          </div>

          {/* Desktop Navigation */}
          <div className="hidden md:flex space-x-8 rtl:space-x-reverse">
            <button onClick={() => setPage('home')} className="text-gray-700 hover:text-indigo-600 transition font-medium">الرئيسية</button>
            <button onClick={() => setPage('catalog')} className="text-gray-700 hover:text-indigo-600 transition font-medium">المنتجات</button>
            <button className="text-gray-700 hover:text-indigo-600 transition font-medium">العروض</button>
            <button className="text-gray-700 hover:text-indigo-600 transition font-medium">من نحن</button>
          </div>

          {/* Icons */}
          <div className="flex items-center space-x-4 rtl:space-x-reverse text-gray-600">
            <button className="hover:text-indigo-600 transition"><Search size={20} /></button>
            <button className="hover:text-indigo-600 transition hidden sm:block"><User size={20} /></button>
            <button className="relative hover:text-indigo-600 transition">
              <ShoppingBag size={20} />
              {cartCount > 0 && (
                <span className="absolute -top-2 -right-2 bg-indigo-600 text-white text-[10px] w-4 h-4 rounded-full flex items-center justify-center">
                  {cartCount}
                </span>
              )}
            </button>
          </div>
        </div>
      </div>

      {/* Mobile Menu */}
      {isOpen && (
        <div className="md:hidden bg-white border-b border-gray-100 p-4 space-y-4">
          <button onClick={() => { setPage('home'); setIsOpen(false); }} className="block w-full text-right text-gray-700">الرئيسية</button>
          <button onClick={() => { setPage('catalog'); setIsOpen(false); }} className="block w-full text-right text-gray-700">المنتجات</button>
          <button className="block w-full text-right text-gray-700">العروض</button>
          <button className="block w-full text-right text-gray-700">من نحن</button>
        </div>
      )}
    </nav>
  );
};

const Hero = ({ setPage }) => (
  <section className="relative h-[500px] md:h-[600px] flex items-center overflow-hidden">
    <div className="absolute inset-0 bg-gray-900">
      <img 
        src="https://images.unsplash.com/photo-1441986300917-64674bd600d8?auto=format&fit=crop&q=80&w=1200" 
        className="w-full h-full object-cover opacity-60" 
        alt="Hero Banner" 
      />
    </div>
    <div className="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-white">
      <h1 className="text-4xl md:text-6xl font-extrabold mb-4 animate-fade-in">اكتشف الأناقة والجودة</h1>
      <p className="text-lg md:text-xl mb-8 max-w-2xl text-gray-100">مجموعتنا الجديدة من المنتجات العصرية المصممة خصيصاً لتناسب أسلوب حياتك المتميز.</p>
      <button 
        onClick={() => setPage('catalog')}
        className="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-4 rounded-full font-bold text-lg transition transform hover:scale-105 flex items-center gap-2"
      >
        تسوق الآن <ArrowRight size={20} />
      </button>
    </div>
  </section>
);

const Benefits = () => (
  <section className="py-12 bg-gray-50 border-y border-gray-100">
    <div className="max-w-7xl mx-auto px-4 grid grid-cols-1 md:grid-cols-3 gap-8">
      <div className="flex items-center gap-4 p-4">
        <div className="bg-indigo-100 p-3 rounded-full text-indigo-600">
          <Truck size={24} />
        </div>
        <div>
          <h3 className="font-bold text-gray-900">شحن سريع</h3>
          <p className="text-sm text-gray-600">توصيل لباب بيتك في 24-48 ساعة</p>
        </div>
      </div>
      <div className="flex items-center gap-4 p-4">
        <div className="bg-indigo-100 p-3 rounded-full text-indigo-600">
          <ShieldCheck size={24} />
        </div>
        <div>
          <h3 className="font-bold text-gray-900">دفع آمن</h3>
          <p className="text-sm text-gray-600">نظام تشفير متطور لحماية بياناتك</p>
        </div>
      </div>
      <div className="flex items-center gap-4 p-4">
        <div className="bg-indigo-100 p-3 rounded-full text-indigo-600">
          <ArrowLeftRight size={24} />
        </div>
        <div>
          <h3 className="font-bold text-gray-900">إرجاع سهل</h3>
          <p className="text-sm text-gray-600">إمكانية الاسترجاع خلال 14 يوماً</p>
        </div>
      </div>
    </div>
  </section>
);

const ProductCard = ({ product, onSelect }) => (
  <div 
    className="group bg-white rounded-xl overflow-hidden border border-gray-100 hover:shadow-xl transition-all duration-300 cursor-pointer"
    onClick={() => onSelect(product)}
  >
    <div className="relative aspect-square overflow-hidden bg-gray-100">
      <img 
        src={product.image} 
        alt={product.name} 
        className="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500" 
      />
      <div className="absolute top-2 right-2 bg-white/90 px-2 py-1 rounded-lg text-xs font-bold text-indigo-600">
        {product.category}
      </div>
    </div>
    <div className="p-4">
      <div className="flex items-center gap-1 text-yellow-400 mb-1">
        <Star size={14} fill="currentColor" />
        <span className="text-xs text-gray-500 font-medium">{product.rating} ({product.reviews})</span>
      </div>
      <h3 className="text-gray-900 font-semibold mb-2 group-hover:text-indigo-600 transition truncate">{product.name}</h3>
      <div className="flex items-center justify-between">
        <span className="text-xl font-bold text-gray-900">{product.price} ر.س</span>
        <button className="bg-gray-900 text-white p-2 rounded-lg hover:bg-indigo-600 transition">
          <ShoppingBag size={18} />
        </button>
      </div>
    </div>
  </div>
);

const Footer = () => (
  <footer className="bg-gray-900 text-gray-300 py-16">
    <div className="max-w-7xl mx-auto px-4 grid grid-cols-1 md:grid-cols-4 gap-12">
      <div className="space-y-4">
        <div className="flex items-center text-white">
          <span className="text-2xl font-bold bg-indigo-600 px-2 py-1 rounded">M</span>
          <span className="ml-2 text-xl font-bold tracking-tight">MODERN STORE</span>
        </div>
        <p className="text-sm leading-relaxed">
          نحن نوفر لك أفضل المنتجات العصرية بأعلى جودة وأفضل سعر. تجربتكم هي أولويتنا القصوى.
        </p>
        <div className="flex space-x-4 rtl:space-x-reverse">
          <Facebook size={20} className="hover:text-indigo-400 cursor-pointer" />
          <Twitter size={20} className="hover:text-indigo-400 cursor-pointer" />
          <Instagram size={20} className="hover:text-indigo-400 cursor-pointer" />
        </div>
      </div>
      
      <div>
        <h4 className="text-white font-bold mb-6">روابط سريعة</h4>
        <ul className="space-y-3 text-sm">
          <li className="hover:text-indigo-400 cursor-pointer">الرئيسية</li>
          <li className="hover:text-indigo-400 cursor-pointer">المتجر</li>
          <li className="hover:text-indigo-400 cursor-pointer">من نحن</li>
          <li className="hover:text-indigo-400 cursor-pointer">تواصل معنا</li>
        </ul>
      </div>

      <div>
        <h4 className="text-white font-bold mb-6">خدمة العملاء</h4>
        <ul className="space-y-3 text-sm">
          <li className="hover:text-indigo-400 cursor-pointer">سياسة الاسترجاع</li>
          <li className="hover:text-indigo-400 cursor-pointer">تتبع الطلب</li>
          <li className="hover:text-indigo-400 cursor-pointer">الأسئلة الشائعة</li>
          <li className="hover:text-indigo-400 cursor-pointer">طرق الشحن</li>
        </ul>
      </div>

      <div>
        <h4 className="text-white font-bold mb-6">النشرة الإخبارية</h4>
        <p className="text-sm mb-4">اشترك للحصول على أحدث العروض والخصومات.</p>
        <div className="flex gap-2">
          <input 
            type="email" 
            placeholder="بريدك الإلكتروني" 
            className="bg-gray-800 border-none rounded-lg px-4 py-2 w-full focus:ring-2 focus:ring-indigo-500" 
          />
          <button className="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition">
            اشتراك
          </button>
        </div>
      </div>
    </div>
    <div className="max-w-7xl mx-auto px-4 mt-16 pt-8 border-t border-gray-800 text-center text-xs">
      &copy; 2025 Modern Store. كل الحقوق محفوظة. تم التطوير بواسطة خلودة.
    </div>
  </footer>
);

// --- Pages ---

const HomePage = ({ setPage, onSelectProduct }) => (
  <div className="animate-fade-in">
    <Hero setPage={setPage} />
    <Benefits />
    
    <section className="py-20 max-w-7xl mx-auto px-4">
      <div className="flex items-center justify-between mb-10">
        <div>
          <h2 className="text-3xl font-bold text-gray-900">منتجات مختارة</h2>
          <p className="text-gray-500 mt-2">اخترنا لك الأفضل في هذا الموسم</p>
        </div>
        <button 
          onClick={() => setPage('catalog')}
          className="text-indigo-600 font-bold flex items-center gap-1 hover:underline"
        >
          عرض الكل <ChevronRight size={20} />
        </button>
      </div>
      <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
        {PRODUCTS.map(product => (
          <ProductCard key={product.id} product={product} onSelect={onSelectProduct} />
        ))}
      </div>
    </section>

    <section className="bg-indigo-600 py-16 text-white text-center">
      <h2 className="text-3xl font-bold mb-4">خصم 20% على أول طلب لك!</h2>
      <p className="mb-8 opacity-90">استخدم الكود WELCOME20 عند الدفع</p>
      <button className="bg-white text-indigo-600 px-8 py-3 rounded-full font-bold hover:bg-gray-100 transition shadow-lg">
        احصل على العرض
      </button>
    </section>

    <section className="py-20 max-w-7xl mx-auto px-4 bg-white">
      <h2 className="text-3xl font-bold text-center mb-16">آراء عملاءنا</h2>
      <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
        {[1, 2, 3].map(i => (
          <div key={i} className="bg-gray-50 p-8 rounded-2xl border border-gray-100 text-center">
            <div className="flex justify-center text-yellow-400 mb-4">
              {[...Array(5)].map((_, idx) => <Star key={idx} size={16} fill="currentColor" />)}
            </div>
            <p className="italic text-gray-600 mb-6 font-medium">"تجربة تسوق رائعة جداً، المنتج وصل في وقت قياسي والجودة فاقت توقعاتي!"</p>
            <div className="font-bold text-gray-900">أحمد محمد</div>
            <div className="text-xs text-gray-400">عميل موثق</div>
          </div>
        ))}
      </div>
    </section>
  </div>
);

const CatalogPage = ({ onSelectProduct }) => (
  <div className="py-12 max-w-7xl mx-auto px-4 min-h-screen">
    <div className="flex flex-col md:flex-row gap-10">
      {/* Sidebar Filters */}
      <aside className="w-full md:w-64 space-y-8">
        <div>
          <h3 className="font-bold text-gray-900 mb-4 flex items-center gap-2">
            <Filter size={18} /> التصفية
          </h3>
          <div className="space-y-2">
            <div className="font-semibold text-sm text-gray-700 mb-2">الأقسام</div>
            {["إلكترونيات", "إكسسوارات", "ملابس"].map(cat => (
              <label key={cat} className="flex items-center gap-2 text-sm text-gray-600 cursor-pointer">
                <input type="checkbox" className="rounded text-indigo-600" /> {cat}
              </label>
            ))}
          </div>
        </div>
        <div>
          <div className="font-semibold text-sm text-gray-700 mb-4">نطاق السعر</div>
          <input type="range" className="w-full accent-indigo-600" min="0" max="2000" />
          <div className="flex justify-between text-xs text-gray-500 mt-2">
            <span>0 ر.س</span>
            <span>2000 ر.س</span>
          </div>
        </div>
      </aside>

      {/* Grid */}
      <div className="flex-1">
        <h1 className="text-3xl font-bold mb-8">كل المنتجات</h1>
        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
          {PRODUCTS.map(product => (
            <ProductCard key={product.id} product={product} onSelect={onSelectProduct} />
          ))}
        </div>
      </div>
    </div>
  </div>
);

const ProductDetailPage = ({ product, addToCart, setPage }) => {
  const [selectedSize, setSelectedSize] = useState('M');

  return (
    <div className="py-12 max-w-7xl mx-auto px-4 min-h-screen">
      <button onClick={() => setPage('catalog')} className="mb-8 flex items-center gap-2 text-gray-500 hover:text-gray-900 font-medium">
        <ArrowLeftRight size={18} className="rotate-180" /> العودة للتسوق
      </button>

      <div className="grid grid-cols-1 md:grid-cols-2 gap-12">
        {/* Gallery */}
        <div className="space-y-4">
          <div className="aspect-square rounded-2xl overflow-hidden bg-gray-100 border border-gray-100">
            <img src={product.image} className="w-full h-full object-cover" alt={product.name} />
          </div>
          <div className="grid grid-cols-4 gap-4">
            {[1,2,3,4].map(i => (
              <div key={i} className="aspect-square rounded-lg overflow-hidden bg-gray-100 border border-gray-200 cursor-pointer opacity-70 hover:opacity-100 transition">
                <img src={product.image} className="w-full h-full object-cover" />
              </div>
            ))}
          </div>
        </div>

        {/* Info */}
        <div className="space-y-6">
          <div className="pb-6 border-b border-gray-100">
            <span className="text-indigo-600 font-bold text-sm tracking-wider uppercase">{product.category}</span>
            <h1 className="text-3xl md:text-4xl font-bold text-gray-900 mt-2">{product.name}</h1>
            <div className="flex items-center gap-2 mt-4">
              <div className="flex text-yellow-400">
                {[...Array(5)].map((_, i) => <Star key={i} size={16} fill={i < 4 ? "currentColor" : "none"} stroke="currentColor" />)}
              </div>
              <span className="text-sm text-gray-500 font-medium">4.8 (124 تقييم)</span>
            </div>
            <div className="text-3xl font-bold text-gray-900 mt-6">{product.price} ر.س</div>
          </div>

          <p className="text-gray-600 leading-relaxed">{product.description}</p>

          <div className="space-y-4">
            <div className="font-bold text-gray-900">المقاس</div>
            <div className="flex gap-3">
              {['S', 'M', 'L', 'XL'].map(size => (
                <button 
                  key={size}
                  onClick={() => setSelectedSize(size)}
                  className={`w-12 h-12 rounded-lg border font-bold transition flex items-center justify-center
                    ${selectedSize === size ? 'bg-gray-900 text-white border-gray-900' : 'bg-white text-gray-600 border-gray-200 hover:border-gray-900'}`}
                >
                  {size}
                </button>
              ))}
            </div>
          </div>

          <div className="flex flex-col sm:flex-row gap-4 pt-6">
            <button 
              onClick={() => addToCart(product)}
              className="flex-1 bg-gray-900 text-white py-4 rounded-xl font-bold text-lg hover:bg-gray-800 transition flex items-center justify-center gap-2"
            >
              إضافة للسلة <ShoppingBag size={20} />
            </button>
            <button className="flex-1 bg-indigo-600 text-white py-4 rounded-xl font-bold text-lg hover:bg-indigo-700 transition">
              شراء الآن
            </button>
          </div>
          
          <div className="bg-gray-50 p-4 rounded-xl space-y-3">
             <div className="flex items-center gap-3 text-sm text-gray-700">
                <Truck size={18} className="text-indigo-600" /> شحن مجاني للطلبات فوق 500 ر.س
             </div>
             <div className="flex items-center gap-3 text-sm text-gray-700">
                <ShieldCheck size={18} className="text-indigo-600" /> ضمان أصلي 100%
             </div>
          </div>
        </div>
      </div>
    </div>
  );
};

// --- Main App Component ---

export default function App() {
  const [page, setPage] = useState('home'); // home, catalog, product
  const [selectedProduct, setSelectedProduct] = useState(null);
  const [cart, setCart] = useState([]);
  const [isLoaded, setIsLoaded] = useState(false);

  useEffect(() => {
    setIsLoaded(true);
    window.scrollTo(0, 0);
  }, [page, selectedProduct]);

  const onSelectProduct = (product) => {
    setSelectedProduct(product);
    setPage('product');
  };

  const addToCart = (product) => {
    setCart([...cart, product]);
    // Simulate a simple notification (in memory for now)
  };

  return (
    <div className="min-h-screen bg-white font-sans text-right" dir="rtl">
      <Navbar setPage={setPage} cartCount={cart.length} />
      
      <main className={`transition-opacity duration-500 ${isLoaded ? 'opacity-100' : 'opacity-0'}`}>
        {page === 'home' && <HomePage setPage={setPage} onSelectProduct={onSelectProduct} />}
        {page === 'catalog' && <CatalogPage onSelectProduct={onSelectProduct} />}
        {page === 'product' && selectedProduct && (
          <ProductDetailPage 
            product={selectedProduct} 
            addToCart={addToCart} 
            setPage={setPage}
          />
        )}
      </main>

      <Footer />

      {/* Quick CSS for animations */}
      <style>{`
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
          animation: fadeIn 0.8s ease-out forwards;
        }
      `}</style>
    </div>
  );
}

          </div>
          <div class="benefit-card">
            <div class="benefit-icon">
              <i class="fas fa-shield-alt"></i>
            </div>
            <h3 class="benefit-title">دفع آمن</h3>
            <p class="benefit-text">نظام تشفير متطور لحماية بياناتك</p>
          </div>
          <div class="benefit-card">
            <div class="benefit-icon">
              <i class="fas fa-undo"></i>
            </div>
            <h3 class="benefit-title">إرجاع سهل</h3>
            <p class="benefit-text">إمكانية الاسترجاع خلال 14 يوماً</p>
          </div>
        </div>
      </section>

      <!-- Featured Offers -->
      <section class="section-container" id="featured-offers-section">
        <div class="section-header">
          <h2 class="section-title">
            <i class="fas fa-bolt"></i>
            عروض حصرية
          </h2>
        </div>
        <div class="offers-carousel">
          <div class="offers-track" id="offers-container"></div>
          <button class="carousel-btn carousel-prev" id="offers-prev">
            <i class="fas fa-chevron-right"></i>
          </button>
          <button class="carousel-btn carousel-next" id="offers-next">
            <i class="fas fa-chevron-left"></i>
          </button>
        </div>
        <div class="carousel-indicators" id="offers-indicators"></div>
      </section>

      <!-- Featured Products -->
      <section class="section-container">
        <div class="section-header">
          <div>
            <h2 class="section-title">
              <i class="fas fa-star"></i>
              منتجات مختارة
            </h2>
            <p class="section-subtitle">اخترنا لك الأفضل في هذا الموسم</p>
          </div>
          <a href="#shop" class="view-all-link">
            عرض الكل
            <i class="fas fa-arrow-left"></i>
          </a>
        </div>
        <div id="featured-products-grid" class="products-grid"></div>
      </section>

      <!-- Promo Banner -->
      <section class="promo-banner">
        <div class="promo-content">
          <h2 class="promo-title">خصم 20% على أول طلب لك!</h2>
          <p class="promo-text">استخدم الكود WELCOME20 عند الدفع</p>
          <button class="btn btn-light btn-large">احصل على العرض</button>
        </div>
      </section>
    </section>

    <!-- صفحة المنتجات -->
    <section class="page-section" id="shop-section" style="display:none;">
      <div class="shop-container">
        <div class="shop-header">
          <h1 class="page-title">المنتجات</h1>
          
          <!-- شريط البحث -->
          <div class="shop-search-box">
            <i class="fas fa-search"></i>
            <input type="text" id="shop-search-input" placeholder="ابحث عن منتج...">
            <button id="clear-search-btn" class="clear-btn" style="display:none;">
              <i class="fas fa-times"></i>
            </button>
          </div>
        </div>

        <!-- فلاتر التصنيف -->
        <div class="categories-filter" id="categories-tabs">
          <button class="category-chip active" data-category="all">الكل</button>
        </div>

        <!-- شبكة المنتجات -->
        <div id="shop-products-grid" class="products-grid"></div>
      </div>
    </section>

    <!-- صفحة المفضلة -->
    <section class="page-section" id="favorites-section" style="display:none;">
      <div class="section-container">
        <h1 class="page-title">
          <i class="fas fa-heart"></i>
          المفضلة
        </h1>
        <div id="favorites-grid" class="products-grid"></div>
      </div>
    </section>

    <!-- صفحة تفاصيل المنتج -->
    <section class="page-section" id="product-details-section" style="display:none;">
    </section>

    <!-- صفحة الطلبات -->
    <section class="page-section" id="orders-section" style="display:none;">
      <div class="section-container">
        <h1 class="page-title">
          <i class="fas fa-box"></i>
          طلباتي
        </h1>
        <div id="orders-list"></div>
      </div>
    </section>

    <!-- صفحة الملف الشخصي -->
    <section class="page-section" id="profile-section" style="display:none;">
      <div class="section-container">
        <div class="profile-card">
          <div class="profile-header">
            <img id="profile-avatar-img" class="profile-avatar" src="https://ui-avatars.com/api/?name=?" alt="Avatar">
            <div class="profile-info">
              <h2 id="profile-fullname" class="profile-name">-</h2>
              <p id="profile-email" class="profile-email">-</p>
              <p class="profile-date">
                <i class="fas fa-calendar"></i>
                عضو منذ <span id="profile-date">-</span>
              </p>
            </div>
          </div>

          <div class="profile-actions">
            <button id="shipping-data-btn" class="btn btn-primary btn-block">
              <i class="fas fa-map-marker-alt"></i>
              بيانات التوصيل
            </button>
            <button id="logout-btn" class="btn btn-danger btn-block">
              <i class="fas fa-sign-out-alt"></i>
              تسجيل الخروج
            </button>
          </div>

          <div class="social-section">
            <h3 class="social-title">تابعنا على</h3>
            <div class="social-links">
              <a href="https://www.facebook.com/share/15xoECsALv/" target="_blank" class="social-link facebook">
                <i class="fab fa-facebook"></i>
                <span>فيسبوك</span>
              </a>
              <a href="https://api.whatsapp.com/send?phone=201559552721" target="_blank" class="social-link whatsapp">
                <i class="fab fa-whatsapp"></i>
                <span>واتساب</span>
              </a>
              <a href="https://tiktok.com/@mz.care" target="_blank" class="social-link tiktok">
                <i class="fab fa-tiktok"></i>
                <span>تيك توك</span>
              </a>
            </div>
          </div>

          <div class="developer-credit">
            Developed by
            <a href="https://instagram.com/1khaledtaher" target="_blank">Khaled</a>
          </div>
        </div>
      </div>
    </section>

    <!-- صفحة من نحن -->
    <section class="page-section" id="about-section" style="display:none;">
      <div class="section-container">
        <h1 class="page-title">تابعنا على فيسبوك</h1>
        <div class="about-content">
          <p>تابعنا على صفحتنا على فيسبوك لتعرف كل جديد!</p>
          <a href="https://www.facebook.com/share/1LiQSDZhnq/" target="_blank" class="btn btn-primary btn-large">
            <i class="fab fa-facebook"></i>
            صفحتنا على فيسبوك
          </a>
        </div>
      </div>
    </section>

    <!-- صفحة العروض -->
    <section class="page-section" id="offers-section" style="display:none;">
      <div class="section-container">
        <h1 class="page-title">
          <i class="fas fa-tags"></i>
          العروض
        </h1>
        <div id="offers-list-section"></div>
      </div>
    </section>

    <!-- صفحة تفاصيل العرض -->
    <section class="page-section" id="offer-details-section" style="display:none;">
      <div class="section-container">
        <button class="back-btn" onclick="history.back()">
          <i class="fas fa-arrow-right"></i>
          العودة
        </button>
        
        <div class="offer-details-card">
          <img id="offer-details-image" src="" alt="صورة العرض" class="offer-details-img">
          <div class="offer-details-content">
            <h1 id="offer-details-name" class="offer-details-title"></h1>
            <p id="offer-details-description" class="offer-details-desc"></p>
            <div id="offer-details-meta" class="offer-details-meta"></div>
          </div>
        </div>

        <div class="offer-products-section">
          <h3 class="section-title">المنتجات المدرجة في العرض</h3>
          <div id="offer-products-grid" class="products-grid"></div>
        </div>
      </div>
    </section>
  </main>

  <!-- Bottom Navigation -->
  <nav id="bottom-nav" class="bottom-nav">
    <a href="#home" class="bottom-nav-item active" data-section="home">
      <i class="fas fa-home"></i>
      <span>الرئيسية</span>
    </a>
    <a href="#shop" class="bottom-nav-item" data-section="shop">
      <i class="fas fa-shopping-bag"></i>
      <span>المنتجات</span>
    </a>
    <a href="#offers" class="bottom-nav-item" data-section="offers">
      <i class="fas fa-tags"></i>
      <span>العروض</span>
    </a>
    <a href="#orders" class="bottom-nav-item" data-section="orders">
      <i class="fas fa-box"></i>
      <span>طلباتي</span>
    </a>
    <a href="#profile" class="bottom-nav-item" data-section="profile">
      <i class="fas fa-user"></i>
      <span>حسابي</span>
    </a>
  </nav>

  <!-- Modals (كل المودالات الموجودة في الكود الأصلي) -->
  
  <!-- Auth Modal -->
  <div id="auth-modal" class="modal-overlay">
    <div class="modal-container auth-modal">
      <button id="close-auth-modal" class="modal-close">
        <i class="fas fa-times"></i>
      </button>
      
      <div class="auth-tabs">
        <button class="auth-tab active" data-tab="login">تسجيل الدخول</button>
        <button class="auth-tab" data-tab="signup">إنشاء حساب</button>
      </div>

      <!-- Login Form -->
      <form id="login-form" class="auth-form">
        <div class="form-group">
          <label>البريد الإلكتروني</label>
          <input type="email" id="login-email" required>
        </div>
        <div class="form-group">
          <label>كلمة المرور</label>
          <div class="password-input">
            <input type="password" id="login-password" required>
            <button type="button" class="password-toggle" onclick="togglePassword('login-password')">
              <i class="fas fa-eye"></i>
            </button>
          </div>
        </div>
        <div id="login-error" class="auth-error" style="display:none;"></div>
        <button type="submit" class="btn btn-primary btn-block">تسجيل الدخول</button>
        <div class="auth-divider">أو</div>
        <button type="button" id="google-login-btn" class="btn btn-google btn-block">
          <i class="fab fa-google"></i>
          تسجيل الدخول بواسطة Google
        </button>
      </form>

      <!-- Signup Form -->
      <form id="signup-form" class="auth-form" style="display:none;">
        <div class="form-group">
          <label>الاسم الكامل</label>
          <input type="text" id="signup-name" required>
        </div>
        <div class="form-group">
          <label>البريد الإلكتروني</label>
          <input type="email" id="signup-email" required>
        </div>
        <div class="form-group">
          <label>كلمة المرور</label>
          <div class="password-input">
            <input type="password" id="signup-password" required>
            <button type="button" class="password-toggle" onclick="togglePassword('signup-password')">
              <i class="fas fa-eye"></i>
            </button>
          </div>
        </div>
        <div id="signup-error" class="auth-error" style="display:none;"></div>
        <button type="submit" class="btn btn-primary btn-block">إنشاء حساب</button>
        <div class="auth-divider">أو</div>
        <button type="button" id="google-signup-btn" class="btn btn-google btn-block">
          <i class="fab fa-google"></i>
          التسجيل بواسطة Google
        </button>
      </form>
    </div>
  </div>

  <!-- Size Selection Modal -->
  <div id="size-selection-modal" class="modal-overlay">
    <div class="modal-container">
      <button id="close-size-modal" class="modal-close">
        <i class="fas fa-times"></i>
      </button>
      <h3 class="modal-title">اختر الحجم</h3>
      <div id="size-selection-product-info" class="size-product-info">
        <img id="size-modal-product-img" src="" alt="Product">
        <div>
          <h4 id="size-modal-product-name"></h4>
          <p id="size-modal-product-desc"></p>
        </div>
      </div>
      <div id="size-options" class="size-options"></div>
      <div class="modal-actions">
        <button id="confirm-size-selection" class="btn btn-primary btn-block">أضف للسلة</button>
        <button id="cancel-size-selection" class="btn btn-outline btn-block">إلغاء</button>
      </div>
    </div>
  </div>

  <!-- Shipping Data Modal -->
  <div id="shipping-data-modal" class="modal-overlay">
    <div class="modal-container">
      <button id="close-shipping-modal" class="modal-close">
        <i class="fas fa-times"></i>
      </button>
      <h3 class="modal-title">بيانات التوصيل</h3>
      
      <div id="shipping-data-display" style="display:none;">
        <div class="data-display">
          <h4>البيانات المحفوظة:</h4>
          <div id="saved-shipping-data"></div>
          <button id="edit-shipping-data" class="btn btn-primary btn-block">تعديل البيانات</button>
        </div>
      </div>
      
      <form id="shipping-data-form" style="display:none;">
        <div class="form-group">
          <label>الاسم بالكامل *</label>
          <input type="text" id="modal-full-name" name="fullName" required>
        </div>
        <div class="form-group">
          <label>رقم الهاتف *</label>
          <input type="tel" id="modal-phone-number" name="phoneNumber" required>
        </div>
        <div class="form-group">
          <label>رقم هاتف آخر (اختياري)</label>
          <input type="tel" id="modal-phone-number-2" name="phoneNumber2">
        </div>
        <div class="form-group">
          <label>العنوان *</label>
          <textarea id="modal-address" name="address" rows="3" required></textarea>
        </div>
        <div class="form-group">
          <label>مكان مميز بجانب العنوان (اختياري)</label>
          <input type="text" id="modal-landmark" name="landmark">
        </div>
        <div class="modal-actions">
          <button type="submit" class="btn btn-primary btn-block">حفظ البيانات</button>
          <button type="button" id="cancel-shipping-data" class="btn btn-outline btn-block">إلغاء</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Image Modal -->
  <div id="image-modal" class="modal-overlay image-modal">
    <button id="close-image-modal" class="modal-close">
      <i class="fas fa-times"></i>
    </button>
    <button id="modal-image-prev" class="image-nav-btn prev">
      <i class="fas fa-chevron-right"></i>
    </button>
    <button id="modal-image-next" class="image-nav-btn next">
      <i class="fas fa-chevron-left"></i>
    </button>
    <img id="modal-image" src="" alt="صورة المنتج">
  </div>

  <!-- Upload Screenshot Modal -->
  <div id="upload-screenshot-modal" class="modal-overlay">
    <div class="modal-container">
      <div class="modal-header">
        <h3 class="modal-title">رفع لقطة شاشة التحويل</h3>
        <button id="close-upload-modal" class="modal-close">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="upload-instructions">
        <p><strong>تعليمات رفع لقطة شاشة التحويل:</strong></p>
        <ul>
          <li>يجب أن تكون الصورة واضحة</li>
          <li>يُفضل أن تكون من نوع JPG أو PNG</li>
          <li>حجم الملف أقل من 5 ميجابايت</li>
        </ul>
      </div>
      <div class="file-upload-area">
        <label for="screenshot-file" class="file-upload-label">
          <i class="fas fa-cloud-upload-alt"></i>
          <span>اختر ملف أو اسحبه هنا</span>
        </label>
        <input type="file" id="screenshot-file" accept="image/*" style="display:none;">
      </div>
      <div id="screenshot-preview" class="screenshot-preview"></div>
      <div class="modal-actions">
        <button id="upload-screenshot-btn" class="btn btn-primary btn-block" disabled>رفع لقطة الشاشة</button>
        <button id="cancel-upload-btn" class="btn btn-outline btn-block">إلغاء</button>
      </div>
    </div>
  </div>

  <!-- Profile Settings Modal -->
  <div id="profile-settings-modal" class="modal-overlay">
    <div class="modal-container">
      <button id="close-profile-settings-modal" class="modal-close">
        <i class="fas fa-times"></i>
      </button>
      <h3 class="modal-title">إعدادات الحساب</h3>
      
      <div id="change-name-section">
        <h4>تغيير الاسم</h4>
        <form id="change-name-form">
          <div class="form-group">
            <label>الاسم الجديد</label>
            <input type="text" id="new-name" required>
          </div>
          <div id="change-name-error" class="auth-error" style="display:none;"></div>
          <button type="submit" class="btn btn-primary btn-block">تغيير الاسم</button>
        </form>
      </div>
      
      <div id="change-password-section" style="display:none;">
        <h4>تغيير كلمة المرور</h4>
        <form id="change-password-form">
          <div class="form-group">
            <label>كلمة المرور الحالية</label>
            <div class="password-input">
              <input type="password" id="current-password" required>
              <button type="button" class="password-toggle" onclick="togglePassword('current-password')">
                <i class="fas fa-eye"></i>
              </button>
            </div>
          </div>
          <div class="form-group">
            <label>كلمة المرور الجديدة</label>
            <div class="password-input">
              <input type="password" id="new-password" required>
              <button type="button" class="password-toggle" onclick="togglePassword('new-password')">
                <i class="fas fa-eye"></i>
              </button>
            </div>
          </div>
          <div class="form-group">
            <label>تأكيد كلمة المرور الجديدة</label>
            <div class="password-input">
              <input type="password" id="confirm-new-password" required>
              <button type="button" class="password-toggle" onclick="togglePassword('confirm-new-password')">
                <i class="fas fa-eye"></i>
              </button>
            </div>
          </div>
          <div id="change-password-error" class="auth-error" style="display:none;"></div>
          <button type="submit" class="btn btn-primary btn-block">تغيير كلمة المرور</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Product Modal -->
  <div id="product-modal" class="modal-overlay">
    <div class="modal-container product-modal">
      <button id="close-product-modal" class="modal-close">
        <i class="fas fa-times"></i>
      </button>
      <img id="modal-product-img" src="" alt="Product">
      <h2 id="modal-product-name"></h2>
      <p id="modal-product-desc"></p>
      <div id="modal-product-extra"></div>
      <div class="modal-actions">
        <button id="modal-add-cart" class="btn btn-primary">
          <i class="fas fa-shopping-bag"></i>
          أضف للسلة
        </button>
        <button id="modal-add-fav" class="btn btn-outline">
          <i class="fas fa-heart"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div id="toast-container"></div>

  <script type="module" src="main.js"></script>
  <script>
    // Toggle Password Visibility
    function togglePassword(inputId) {
      const input = document.getElementById(inputId);
      const icon = input.nextElementSibling.querySelector('i');
      if (input.type === 'password') {
        input.type = 'text';
        icon.classList.remove('fa-eye');
        icon.classList.add('fa-eye-slash');
      } else {
        input.type = 'password';
        icon.classList.remove('fa-eye-slash');
        icon.classList.add('fa-eye');
      }
    }
  </script>
</body>
</html>
